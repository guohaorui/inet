[General]
network = EthernetFilteringExample

*.numSources = 3
*.sources[*].packetLength = 100B
*.sources[0].productionInterval = replaceUnit(sin(dropUnit(simTime() * 1)) + sin(dropUnit(simTime() * 8)) + 10, "ms") / 100
*.sources[1].productionInterval = replaceUnit(sin(dropUnit(simTime() * 2)) + 1.5, "ms") / 10
*.sources[2].productionInterval = replaceUnit(sin(dropUnit(simTime() * 3)) + 1.5, "ms") / 10

*.identifier.streamMappings = [{packet: "sources[0]*", stream: "s0"},
                               {packet: "sources[1]*", stream: "s1"},
                               {packet: "sources[2]*", stream: "s2"}]

*.filter.typename = "SimpleIeee8021qciFilter"
*.filter.numStreams = 3
*.filter.classifier.streamsToGateIndices = "s0 0 s1 1 s2 2"

[Config SlidingWindowRateMeter]

*.filter.meter[*].typename = "SlidingWindowRateMeter"
*.filter.meter[*].timeWindow = 100ms
*.filter.filter[*].typename = "StatisticalRateLimiter"
*.filter.filter[*].maxDatarate = 8Mbps

[Config SingleRateTwoColorMeter]

*.filter.meter[*].typename = "SingleRateTwoColorMeter"
*.filter.meter[*].cir = 8Mbps
*.filter.meter[*].cbs = 100kB

[Config DualRateThreeColorMeter]

*.filter.meter[*].typename = "DualRateThreeColorMeter"
*.filter.meter[*].cir = 8Mbps
*.filter.meter[*].cbs = 100kB
*.filter.meter[*].eir = 2Mbps
*.filter.meter[*].ebs = 100kB

[Config StreamFilterTable]
*.filter.typename = "Ieee8021qciFilter"
*.filter.numStreams = 3
*.filter.numGates = 2
*.filter.numMeters = 2
*.filter.streamFilterTable = [{stream: "s0", gate: 0, meter: 0},
                              {stream: "s1", gate: 0, meter: 1},
                              {stream: "s2", gate: 1, meter: 1}]
*.filter.streamFilter[*].backpressure = true
*.filter.gc[0].streamsToGateIndices = "s0 0 s1 1" # should be automated from above
*.filter.gc[1].streamsToGateIndices = "s2 0"
*.filter.meter[*].typename = "SingleRateTwoColorMeter"
*.filter.meter[*].cir = 8Mbps
*.filter.meter[*].cbs = 10000B
